<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>그래프페이지 레이아웃</title>
    <link rel="stylesheet" type="text/css" href="src/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="src/bootstrap/bootstrap-theme.min.css">
    <link rel="stylesheet" type="text/css" href="src/css/main.css">
    <link rel="stylesheet" type="text/css" href="src/css/yg.css">
</head>
<body>

<!--메뉴 레이아웃-->
<div class="row" style="max-width:960px; margin:200px auto;background:#f4ebdd">
    <div class="tabAreaWrap col-xs-9">
        <div class="menuReviewWrap row">
            <ul>
            </ul>

            <div class="menuTabContent col-xs-12">
                <div class="menuTabGraph" style="background-color: #fff;">
                    <div class="competition-podium well">
                        <div class="podium-block gold">
                            <div class="orders"></div>
                            <div class="name">danb</div>
                            <div class="podium"><span>1등</span></div>
                        </div>
                        <div class="podium-block silver">
                            <div class="orders"></div>
                            <div class="name">youngun</div>
                            <div class="podium"><span>2등</span></div>
                        </div>
                        <div class="podium-block bronze">
                            <div class="orders"></div>
                            <div class="name">hjk</div>
                            <div class="podium"><span>3등</span></div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="mkbTabContent col-xs-12">

            </div>
        </div>

    </div>

    <!--옆에 업소 상세 플롯-->
    <div class="col-xs-3 storeDetailBox">
        <div class="storeDetailHead">
            업소상세정보
        </div>
        <div class="storeDetailTable">
            <table>
                <tr>
                    <td class="storeDetailTableLeft">최소금액</td>
                    <td class="storeDetailTableRight">13,000원 부터</td>
                </tr>
                <tr>
                    <td class="storeDetailTableLeft">운영시간</td>
                    <td class="storeDetailTableRight">낮 12:00 ~ 오후 11:50</td>
                </tr>
                <tr>
                    <td class="storeDetailTableLeft">전화번호</td>
                    <td class="storeDetailTableRight phoneFontColor">050-4824-9382</td>
                </tr>
                <tr>
                    <td class="storeDetailTableLeft">업소소개</td>
                    <td class="storeDetailTableRight">맛있는 치킨 코리엔탈 깻잎치킨 평촌1호점 입니다^^</td>
                </tr>
            </table>
        </div>
    </div>


</div>


<script src="./dist/index.bundle.js"></script>
<script src="./src/index.js"></script>
<script src="./src/yg.js"></script>
<script type="text/javascript">

    document.addEventListener("DOMContentLoaded", function () {
        podiumAnimate();

        function podiumAnimate() {
            let gold = document.querySelector('.gold .podium');
            gold.style.transition = 'all 1.5s ease';
            gold.style.height = '180px';

            let silver = document.querySelector('.silver .podium');
            silver.style.transition = 'all 1.5s ease';
            silver.style.height = '120px';

            let bronze = document.querySelector('.bronze .podium');
            bronze.style.transition = 'all 1.5s ease';
            bronze.style.height = '80px';
        }
        var mkbLoad = function () {
          var xhr = new XMLHttpRequest();
          xhr.onload = function () {
            if (xhr.status === 200) {
              let orders = JSON.parse(xhr.responseText);
              let rankers = {};
              for (let i = 0; i < orders.length; i++) {
                if (orders[i].buyerId in rankers) {
                  rankers[orders[i].buyerId] += 1;
                } else {
                  rankers[orders[i].buyerId] = 1;
                }
              }

              let items = Object.keys(rankers).map(function (key) {
                return [key, rankers[key]];
              });

              items.sort(function (first, second) {
                return second[1] - first[1];
              });

              let top3 = items.slice(0, 3);

              let top3_name = document.querySelectorAll('.name');
              let top3_order = document.querySelectorAll('.orders');

              for (let i = 0; i < 3; i++) {
                let name = top3[i].toString().split(",")[0];
                let order = top3[i].toString().split(",")[1];
                top3_name[i].innerHTML = name;
                top3_order[i].innerHTML = order;
              }

            }

          }

          xhr.open('GET', 'http://52.78.184.77:3000/orders/bystore/101010', true);
          xhr.send(null);
      }

      mkbLoad()


    })

</script>
</body>
</html>
