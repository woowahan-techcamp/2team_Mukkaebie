<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <link rel="shortcut icon" href="http://img.woowahan.com/www/common/favicon.ico">
    <title>지점 페이지</title>
    <link rel="stylesheet" type="text/css" href="./src/bootstrap/bootstrap-theme.min.css">
    <link rel="stylesheet" type="text/css" href="./src/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="./dist/style.css">
</head>

<body>
<script id="reviewTemplate" type="text/template">
    <div class="reviewCard">
        <div class="reviewCardPic">
        </div>
        <div class="reviewCardContent">
            <div class="reviewCardTop p-x-1">
                <div class="reviewCardId float-left">
                    ${userId}
                </div>
                <span class="float-left p-x-1">
            |
          </span>
                <div class="reviewCardDate float-left">
                    ${createdDate}
                </div>
            </div>
            <div class="reviewCardMid p-x-1">
                <span class="reviewCardStar float-left">${orangeStar}</span>
                <span class="reviewCardNostar float-left">${greyStar}</span>
            </div>
            <div class="reviewCardBtm p-a-1">
                ${reviewContent}
            </div>
        </div>
    </div>
</script>
<script id="storeListTemplate" type="text/template">
    <div class="col-xs-4">
        <a href="#" value="${storeId}">
            <div class="storeCard">
                <div class="storeCardLeft">
                    <img src=${storeImg}>
                </div>
                <div class="storeCardRight">
                    <div class="storeCardTitle">${storeName}</div>
                    <div class="storeCardStars">
                        <span class="storeCardGreyStar">
                            <span class="storeCardOrangeStar"></span>
                        </span>
                    </div>
                    <div class="storeCardAddress">
                        ${address}
                    </div>
                    <div class="storeCardReviewSection">
                        <span class="storeCardReviewKey">리뷰</span>
                        <span class="storeCardReviewValue">11</span>
                        <span class="storeCardReviewKey">사장님 댓글</span>
                        <span class="storeCardReviewValue">11</span>
                    </div>
                    <div class="storeCardLabel">
                        <span>바로결제</span>
                        <span>만나서결제</span>
                    </div>
                </div>
            </div>
        </a>
    </div>
</script>



<div class="row header m-x-0">
    <div class="float-right p-a-1 loginMenu">ygna91님 | 마이페이지 | 로그아웃 | 고객센터 | 즐겨찾기</div>
    <div class="baeminMainLogo"></div>

    <div class="searchArea">
        <div class="float-left p-r-1">
            <div class="locationSelect">
                송파구 방이동
            </div>
            <div class="locationSelectButton"></div>
        </div>
        <div class="float-left">
            <input class="searchBox" type="text">
            <div class="searchBoxButton"></div>
        </div>
    </div>

</div>
<div class="mobileTitleArea row m-x-0">
    <div class="float-left mobileTitleButton"></div>
    <div class="mobileTitleImg"></div>
</div>

<div class="row blackMenuArea m-x-0">
    <ul class="categoryWrapper">
        <li class="blackMenuChicken blackMenu" data="치킨"></li>
        <li class="blackMenuChinese blackMenu" data="중국집"></li>
        <li class="blackMenuPizza blackMenu" data="피자"></li>
        <li class="blackMenuKorean blackMenu" data="한식"></li>
        <li class="blackMenuPigfeet blackMenu" data="족발"></li>
        <li class="blackMenuNight blackMenu" data="야식"></li>
        <li class="blackMenuJapanese blackMenu" data="일식"></li>
        <li class="blackMenuSoup blackMenu" data="찜탕"></li>
        <li class="blackMenuVento blackMenu" data="도시락"></li>
        <li class="blackMenuFastfood blackMenu" data="패스트푸드"></li>
        <li class="blackMenuQuickpay blackMenu" data="바로결제"></li>
        <li class="blackMenuTogether blackMenu" data="모아보기"></li>
    </ul>
</div>

<div class="mobileCategory col-xs-12">
    <div class="mobileCategorySearch col-xs-12">
        <input type="text" placeholder="업소명을 검색해주세요">
    </div>
    <div class="mobileMenuWrap">
        <div class="col-xs-4 mobileMenu" data="치킨">치킨</div>
        <div class="col-xs-4 mobileMenu" data="중국집">중국집</div>
        <div class="col-xs-4 mobileMenu" data="피자">피자</div>
    </div>
    <div class="mobileMenuWrap">
        <div class="col-xs-4 mobileMenu" data="한식">한식,분식</div>
        <div class="col-xs-4 mobileMenu" data="족발">족발,보쌈</div>
        <div class="col-xs-4 mobileMenu" data="야식">야식</div>
    </div>
    <div class="mobileMenuWrap">
        <div class="col-xs-4 mobileMenu" data="일식">돈까스,회,일식</div>
        <div class="col-xs-4 mobileMenu" data="찜탕">찜,탕</div>
        <div class="col-xs-4 mobileMenu" data="도시락">도시락</div>
    </div>
    <div class="mobileMenuWrap">
        <div class="col-xs-4 mobileMenu" data="패스트푸드">패스트푸드</div>
        <div class="col-xs-4 mobileMenu" data="바로결제">바로결제</div>
        <div class="col-xs-4 mobileMenu" data="모아보기">모아보기</div>
    </div>
</div>

<!--메뉴 레이아웃-->
<div class="row storeLayout m-x-auto">
    <div class="storeTitleAreaWrap col-xs-12 m-y-2">
        <div class="storeTitleArea">
            <div class="float-left">
                <span class="storeTitle">깻잎치킨 평촌1호점</span>
                <span>|</span>
                <span class="storeAddress">경기도 안양시 동안구 비산</span>
            </div>
            <div class="float-left m-l-2 storeStars">
                <span class="orangeFontColor float-left">★★★★</span>
                <span class="float-left">★</span>
                <span>13명</span>
            </div>
            <div class="float-right">
                <span class="storeTitleLabel">카드결제</span>
                <span class="storeTitleLabel">휴대폰결제</span>
                <span class="storeTitleLabel">포인트적립</span>
            </div>
        </div>
    </div>
    <!--옆에 업소 상세 플롯-->
    <div class="storeSideAreaWrap col-xs-3 float-right">
        <div class="storeDetailBox">
            <div class="storeDetailHead">
                업소상세정보
            </div>
            <div class="storeDetailTable">
                <table>
                    <tr>
                        <td class="storeDetailTableLeft">최소금액</td>
                        <td class="storeDetailTableRight">13,000원 부터</td>
                    </tr>
                    <tr>
                        <td class="storeDetailTableLeft">운영시간</td>
                        <td class="storeDetailTableRight">낮 12:00 ~ 오후 11:50</td>
                    </tr>
                    <tr>
                        <td class="storeDetailTableLeft">전화번호</td>
                        <td class="storeDetailTableRight orangeFontColor">050-4824-9382</td>
                    </tr>
                    <tr>
                        <td class="storeDetailTableLeft">업소소개</td>
                        <td class="storeDetailTableRight">맛있는 치킨 코리엔탈 깻잎치킨 평촌1호점 입니다^^</td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="storeCart">
            <div class="storeCartHead">장바구니</div>
            <div class="storeCartContent">
                <span>랜덤 주문</span>
                <span class="orangeFontColor">1개</span>
            </div>
            <div class="storeCartTotal">
                <span>주문금액합계</span>
                <span class="orangeFontColor">0 원</span>
            </div>
            <div class="cartOrderButton" id="cartOrderButton">주문하기</div>
        </div>
    </div>
    <div class="tabAreaWrap float-right col-xs-9">
        <div class="menuReviewWrap row m-x-0">
            <ul id="storeTabWrapper">
                <li class="storeTab selectedTab" id="menuTab">
                    메뉴
                </li>
                <li class="storeTab" id="mkbTab">
                    먹깨비
                    <span class="orangeFontColor">New</span>
                </li>
                <li class="storeTab" id="reviewTab">
                    리뷰
                </li>
            </ul>


            <div id="storeTabContentWrapper">
                <div class="selectedContent menuTabContent col-xs-12 storeTabContent" id="cont-menuTab">
                    <!--그래프 시작-->
                    <div class="menuTabGraph">
                        <figure style="text-align:center">
                            <div class="figure-content">
                                <svg width="80%" height="80%" viewBox="0 0 42 42" class="donut"
                                     aria-labelledby="menu-title menu-desc"
                                     role="img">
                                    <title id="menu-title">도넛 차트</title>
                                    <desc id="menu-desc">도넛 차트는 해당 업소의 주문량 기준 상위 3개 인기 메뉴를 보여준다.</desc>

                                    <circle class="donut-hole" cx="21" cy="21" r="15.91549430918954" fill="#fff"
                                            role="presentation"></circle>
                                    <circle class="donut-ring" cx="21" cy="21" r="15.91549430918954" fill="transparent"
                                            stroke="#d2d3d4"
                                            stroke-width="8" role="presentation"></circle>
                                    <!-- unused remain share -->

                                </svg>
                            </div>
                            <figcaption class="figure-key">
                                <p class="sr-only">도넛 차트는 해당 업소의 주문량 기준 상위 3개 인기 메뉴를 보여준다.</p>

                                <ul class="figure-key-list" aria-hidden="true" role="presentation">
                                    <li class="donutLabel">
                                        <span class="shape-rect shape-1"></span>
                                        <span class="labelText"></span>
                                    </li>
                                    <li class="donutLabel">
                                        <span class="shape-rect shape-2"></span>
                                        <span class="labelText"></span>
                                    </li>
                                    <li class="donutLabel">
                                        <span class="shape-rect shape-3"></span>
                                        <span class="labelText"></span>
                                    </li>
                                    <li class="donutLabel">
                                        <span class="shape-rect shape-4"></span>
                                        <span class="labelText"></span>
                                    </li>
                                    <li class="donutLabel">
                                        <span class="shape-rect shape-5"></span>
                                        <span class="labelText"></span>
                                    </li>
                                    <li class="donutLabel">
                                        <span class="shape-rect shape-6"></span>
                                        <span class="labelText"></span>
                                    </li>
                                </ul>
                            </figcaption>
                        </figure>
                    </div>
                    <!--그래프 끝-->
                    <div class="foldableLevel1">
                        <h6>순살세트</h6>
                        <p>순살에 대한 설명이 들어갑니다.</p>
                    </div>
                    <div class="foldableLevel2">
                        <div class="foldableLevel1">순살세트</div>
                        <div class="foldableLevel2">
                            <p>Lorem ipsum..</p>
                        </div>
                    </div>

                    <div class="foldableLevel1">
                        <h6>순살세트</h6>
                        <p>순살에 대한 설명이 들어갑니다.</p>
                    </div>
                    <div class="foldableLevel2">
                        <p>Lorem ipsum...</p>
                    </div>

                    <div class="foldableLevel1">
                        <h6>순살세트</h6>
                        <p>순살에 대한 설명이 들어갑니다.</p>
                    </div>
                    <div class="foldableLevel2">
                        <p>Lorem ipsum...</p>
                    </div>

                </div>
                <div class="mkbTabContent col-xs-12 storeTabContent" id="cont-mkbTab">
                    <div class="menuTabGraph" style="background-color: #fff;">
                        <div class="competition-podium well">
                            <div class="podium-block gold">
                                <div class="orders"></div>
                                <div class="name">danb</div>
                                <div class="podium"><span>1등</span></div>
                            </div>
                            <div class="podium-block silver">
                                <div class="orders"></div>
                                <div class="name">youngun</div>
                                <div class="podium"><span>2등</span></div>
                            </div>
                            <div class="podium-block bronze">
                                <div class="orders"></div>
                                <div class="name">hjk</div>
                                <div class="podium"><span>3등</span></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="reviewTabContent col-xs-12 storeTabContent" id="cont-reviewTab">
                    <p class="p-t-3 orangeFontColor">리뷰 작성하기</p>
                    <div class="reviewWriteBox p-a-3">
                        <p name="userId" value="ygtech">ygtech</p>
                        <textarea id="reviewTextInput" type="text" name="content"></textarea>
                        <button id="reviewTextInputBtn" class="float-right">작성</button>
                    </div>
                    <p class="orangeFontColor">리뷰 목록</p>
                    <div id="reviewList">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row footer m-x-0"></div>

<script src="./dist/index.bundle.js"></script>
<script>

  class StoreList {

    constructor(cat){
      this.getStoreList(cat);
    }

    getStoreList(cat) {
      let xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {

          const layoutTarget = document.querySelector(".storeLayout");
          layoutTarget.innerHTML = '<div class="m-x-3 m-b-2">홈 >	피자|서울 송파구 잠실4동을 중심으로	총 71곳을 찾았습니다.</div><div class="col-xs-12 storeCardRow"></div>';
          const response = JSON.parse(this.responseText);
          const renderTarget = document.querySelector(".storeCardRow");
          renderTarget.innerHTML = "";
          response.forEach(function (oneStore) {
            const store = oneStore;
            const storeId = store.storeId;
            const storeImg = store.storeImg;
            const storeName = store.storeName;
            const address = store.address;
            const tempGrab = document.querySelector("#storeListTemplate").text;
            const result = eval('`' + tempGrab + '`');
            renderTarget.innerHTML += result;
          })
        }
      };
      xhttp.open("GET", "http://13.124.179.176:3000/stores/bycategory/" + cat, true);
      xhttp.send();
    }

  }

  let clickedMenu = document.querySelector(".categoryWrapper");
  clickedMenu.addEventListener("click", function(e) {
    if (e.target.tagName !== "LI") {
      e.target = e.target.closest(".blackMenu");
    }
    let categoryList = new StoreList(e.target.attributes.data.value);
  });


  let clickedMobileMenu = document.querySelector(".mobileCategory");
  clickedMobileMenu.addEventListener("click", function(e) {
    if (e.target.className !== "col-xs-4 mobileMenu"){
      e.target = e.target.closest(".mobilekMenu");
    }
    let categoryList = new StoreList(e.target.attributes.data.value);
  });

</script>
</body>
</html>
